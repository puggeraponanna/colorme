extension: ".lua"
template: |
  -- Neovim colorscheme (Catppuccin-style organization)
  local flavors = {
    colorme = {
      background = "{{background_mode}}", -- "light" or "dark"
      base = "{{background}}",
      text = "{{foreground}}",
      surface0 = "{{selection_background}}",
      overlay0 = "{{bright_black}}",
      blue = "{{blue}}",
      magenta = "{{magenta}}",
      cyan = "{{cyan}}",
      green = "{{green}}",
      yellow = "{{yellow}}",
      red = "{{red}}",
      maroon = "{{bright_red}}",
      teal = "{{bright_cyan}}",
      sky = "{{bright_blue}}",
      pink = "{{bright_magenta}}",
    }
  }

  local cp = flavors["colorme"]

  -- Transparency toggle (default to false, but easy to change)
  local transparent = false
  local bg = transparent and "NONE" or cp.base

  vim.cmd("highlight clear")
  vim.o.termguicolors = true
  vim.o.background = cp.background or "dark"
  vim.g.colors_name = "colorme"

  local groups = {
    -- Base highlights
    Normal = { fg = cp.text, bg = bg },
    NormalNC = { fg = cp.text, bg = bg },
    SignColumn = { bg = bg },
    MsgArea = { fg = cp.text, bg = bg },
    EndOfBuffer = { fg = bg }, -- Hide the ~ symbols
    
    CursorLine = { bg = cp.surface0 },
    Visual = { bg = cp.surface0, bold = true },
    Search = { fg = cp.base, bg = cp.yellow },
    IncSearch = { fg = cp.base, bg = cp.pink },
    
    -- Syntax
    Comment = { fg = cp.overlay0, italic = true },
    Constant = { fg = cp.pink },
    String = { fg = cp.green },
    Character = { fg = cp.green },
    Number = { fg = cp.orange or cp.maroon },
    Boolean = { fg = cp.orange or cp.maroon },
    Float = { fg = cp.orange or cp.maroon },
    
    Identifier = { fg = cp.sky },
    Function = { fg = cp.blue },
    
    Statement = { fg = cp.magenta },
    Conditional = { fg = cp.magenta },
    Repeat = { fg = cp.magenta },
    Label = { fg = cp.magenta },
    Operator = { fg = cp.cyan },
    Keyword = { fg = cp.magenta },
    Exception = { fg = cp.magenta },
    
    PreProc = { fg = cp.pink },
    Include = { fg = cp.pink },
    Define = { fg = cp.pink },
    Macro = { fg = cp.pink },
    PreCondit = { fg = cp.pink },
    
    Type = { fg = cp.yellow },
    StorageClass = { fg = cp.yellow },
    Structure = { fg = cp.yellow },
    Typedef = { fg = cp.yellow },
    
    Special = { fg = cp.pink },
    SpecialChar = { fg = cp.pink },
    Tag = { fg = cp.pink },
    Delimiter = { fg = cp.cyan },
    SpecialComment = { fg = cp.overlay0, italic = true },
    Debug = { fg = cp.red },
    
    Underlined = { underline = true },
    Ignore = { fg = cp.base },
    Error = { fg = cp.red, bold = true },
    Todo = { fg = cp.base, bg = cp.yellow, bold = true },

    -- Treesitter
    ["@variable"] = { fg = cp.text },
    ["@variable.builtin"] = { fg = cp.red },
    ["@variable.parameter"] = { fg = cp.maroon, italic = true },
    ["@variable.member"] = { fg = cp.red },

    ["@constant"] = { fg = cp.pink },
    ["@constant.builtin"] = { fg = cp.pink },
    ["@constant.macro"] = { fg = cp.pink },

    ["@module"] = { fg = cp.sky },
    ["@module.builtin"] = { fg = cp.sky },
    
    ["@label"] = { fg = cp.magenta },

    ["@string"] = { fg = cp.green },
    ["@string.documentation"] = { fg = cp.green },
    ["@string.regexp"] = { fg = cp.orange or cp.maroon },
    ["@string.escape"] = { fg = cp.pink },
    ["@string.special"] = { fg = cp.pink },

    ["@character"] = { fg = cp.green },
    ["@character.special"] = { fg = cp.pink },

    ["@boolean"] = { fg = cp.orange or cp.maroon },
    ["@number"] = { fg = cp.orange or cp.maroon },
    ["@number.float"] = { fg = cp.orange or cp.maroon },

    ["@type"] = { fg = cp.yellow },
    ["@type.builtin"] = { fg = cp.yellow },
    ["@type.definition"] = { fg = cp.yellow },
    ["@type.qualifier"] = { fg = cp.yellow },

    ["@attribute"] = { fg = cp.blue },
    ["@property"] = { fg = cp.red },

    ["@function"] = { fg = cp.blue },
    ["@function.builtin"] = { fg = cp.blue },
    ["@function.call"] = { fg = cp.blue },
    ["@function.macro"] = { fg = cp.blue },
    ["@function.method"] = { fg = cp.blue },
    ["@function.method.call"] = { fg = cp.blue },

    ["@constructor"] = { fg = cp.magenta },
    ["@operator"] = { fg = cp.cyan },

    ["@keyword"] = { fg = cp.magenta },
    ["@keyword.coroutine"] = { fg = cp.magenta },
    ["@keyword.function"] = { fg = cp.magenta },
    ["@keyword.operator"] = { fg = cp.magenta },
    ["@keyword.import"] = { fg = cp.pink },
    ["@keyword.type"] = { fg = cp.magenta },
    ["@keyword.modifier"] = { fg = cp.magenta },
    ["@keyword.repeat"] = { fg = cp.magenta },
    ["@keyword.return"] = { fg = cp.magenta },
    ["@keyword.debug"] = { fg = cp.magenta },
    ["@keyword.exception"] = { fg = cp.magenta },
    ["@keyword.conditional"] = { fg = cp.magenta },
    ["@keyword.directive"] = { fg = cp.pink },
    ["@keyword.directive.define"] = { fg = cp.pink },

    ["@punctuation.delimiter"] = { fg = cp.cyan },
    ["@punctuation.bracket"] = { fg = cp.text },
    ["@punctuation.special"] = { fg = cp.cyan },

    ["@comment"] = { fg = cp.overlay0, italic = true },
    ["@comment.documentation"] = { fg = cp.overlay0 },
    ["@comment.error"] = { fg = cp.red },
    ["@comment.warning"] = { fg = cp.yellow },
    ["@comment.todo"] = { fg = cp.base, bg = cp.yellow },
    ["@comment.note"] = { fg = cp.base, bg = cp.sky },

    ["@markup.strong"] = { bold = true },
    ["@markup.italic"] = { italic = true },
    ["@markup.strikethrough"] = { strikethrough = true },
    ["@markup.underline"] = { underline = true },

    ["@markup.heading"] = { fg = cp.blue, bold = true },

    ["@markup.quote"] = { fg = cp.overlay0 },
    ["@markup.math"] = { fg = cp.cyan },
    ["@markup.environment"] = { fg = cp.magenta },

    ["@markup.link"] = { fg = cp.blue },
    ["@markup.link.label"] = { fg = cp.blue },
    ["@markup.link.url"] = { fg = cp.sky, underline = true },

    ["@markup.raw"] = { fg = cp.green },
    ["@markup.raw.block"] = { fg = cp.green },

    ["@markup.list"] = { fg = cp.magenta },
    ["@markup.list.checked"] = { fg = cp.green },
    ["@markup.list.unchecked"] = { fg = cp.text },

    ["@diff.plus"] = { fg = cp.green },
    ["@diff.minus"] = { fg = cp.red },
    ["@diff.delta"] = { fg = cp.yellow },

    ["@tag"] = { fg = cp.magenta },
    ["@tag.attribute"] = { fg = cp.yellow },
    ["@tag.delimiter"] = { fg = cp.cyan },

    -- UI
    Pmenu = { fg = cp.text, bg = cp.surface0 },
    PmenuSel = { fg = cp.text, bg = cp.overlay0, bold = true },
    LineNr = { fg = cp.overlay0 },
    CursorLineNr = { fg = cp.blue, bold = true },
    VertSplit = { fg = cp.surface0 },
    StatusLine = { fg = cp.text, bg = cp.surface0 },
    StatusLineNC = { fg = cp.overlay0, bg = cp.surface0 },

    -- Floating Windows
    NormalFloat = { fg = cp.text, bg = cp.base },
    FloatBorder = { fg = cp.blue },

    -- LSP
    LspReferenceText = { bg = cp.surface0 },
    LspReferenceRead = { bg = cp.surface0 },
    LspReferenceWrite = { bg = cp.surface0 },
    LspSignatureActiveParameter = { fg = cp.blue, bold = true },

    -- Cursor & Mode
    Cursor = { fg = cp.base, bg = cp.text },
    TermCursor = { fg = cp.base, bg = cp.text },
    ModeMsg = { fg = cp.text, bold = true },

    -- Lualine (ensure dark text on colored backgrounds)
    lualine_a_normal = { fg = cp.base, bg = cp.blue, bold = true },
    lualine_a_insert = { fg = cp.base, bg = cp.green, bold = true },
    lualine_a_visual = { fg = cp.base, bg = cp.magenta, bold = true },
    lualine_a_replace = { fg = cp.base, bg = cp.red, bold = true },
    lualine_a_command = { fg = cp.base, bg = cp.yellow, bold = true },

    -- Lualine CamelCase variants
    LualineANormal = { fg = cp.base, bg = cp.blue, bold = true },
    LualineAInsert = { fg = cp.base, bg = cp.green, bold = true },
    LualineAVisual = { fg = cp.base, bg = cp.magenta, bold = true },
    LualineAReplace = { fg = cp.base, bg = cp.red, bold = true },
    LualineACommand = { fg = cp.base, bg = cp.yellow, bold = true },

    -- Diff groups (used by Lualine 'auto' theme for mode indicators)
    DiffAdd = { fg = cp.base, bg = cp.green },
    DiffChange = { fg = cp.base, bg = cp.yellow },
    DiffDelete = { fg = cp.base, bg = cp.red },
    DiffText = { fg = cp.base, bg = cp.blue },

    -- Diagnostics
    DiagnosticError = { fg = cp.red },
    DiagnosticWarn = { fg = cp.yellow },
    DiagnosticInfo = { fg = cp.sky },
    DiagnosticHint = { fg = cp.teal },
    DiagnosticUnderlineError = { sp = cp.red, underline = true },
    DiagnosticUnderlineWarn = { sp = cp.yellow, underline = true },
    DiagnosticUnderlineInfo = { sp = cp.sky, underline = true },
    DiagnosticUnderlineHint = { sp = cp.teal, underline = true },

    -- NvimTree
    NvimTreeNormal = { fg = cp.text, bg = bg },
    NvimTreeNormalNC = { fg = cp.text, bg = bg },
    NvimTreeRootFolder = { fg = cp.blue, bold = true },
    NvimTreeGitDirty = { fg = cp.yellow },
    NvimTreeGitNew = { fg = cp.green },
    NvimTreeGitDeleted = { fg = cp.red },
    NvimTreeSpecialFile = { fg = cp.magenta, underline = true },
    NvimTreeIndentMarker = { fg = cp.surface0 },
    NvimTreeImageFile = { fg = cp.pink },
    NvimTreeSymlink = { fg = cp.cyan },
    NvimTreeFolderName = { fg = cp.blue },
    NvimTreeOpenedFolderName = { fg = cp.blue, italic = true },
    NvimTreeEmptyFolderName = { fg = cp.overlay0 },
    NvimTreeWindowPicker = { fg = cp.text, bg = cp.surface0, bold = true },

    -- lazy.nvim
    LazyNormal = { fg = cp.text, bg = bg },
    LazyButton = { bg = cp.surface0 },
    LazyButtonActive = { bg = cp.overlay0, bold = true },
    LazySpecial = { fg = cp.blue },
    LazyDir = { fg = cp.sky },
    LazyUrl = { fg = cp.blue },
    LazyCommit = { fg = cp.green },
    LazyNoDiff = { fg = cp.overlay0 },
    LazyH1 = { fg = cp.blue, bg = cp.surface0, bold = true },
    LazyH2 = { fg = cp.blue, bold = true },
    LazyProgressDone = { fg = cp.blue },
    LazyProgressTodo = { fg = cp.overlay0 },

    -- Telescope
    TelescopeBorder = { fg = cp.surface0, bg = bg },
    TelescopeNormal = { fg = cp.text, bg = bg },
    TelescopeSelection = { bg = cp.surface0 },
    TelescopeMatching = { fg = cp.pink, bold = true },
    TelescopePromptPrefix = { fg = cp.blue },
    TelescopePromptNormal = { fg = cp.text, bg = cp.base },
    TelescopeResultsNormal = { fg = cp.text, bg = bg },
    TelescopePreviewNormal = { fg = cp.text, bg = bg },

    -- GitSigns
    GitSignsAdd = { fg = cp.green },
    GitSignsChange = { fg = cp.yellow },
    GitSignsDelete = { fg = cp.red },

    -- WhichKey
    WhichKey = { fg = cp.blue },
    WhichKeyGroup = { fg = cp.magenta },
    WhichKeyDesc = { fg = cp.sky },
    WhichKeySeparator = { fg = cp.overlay0 },
    WhichKeyFloat = { bg = cp.base },
    WhichKeyValue = { fg = cp.overlay0 },
  }

  for group, hl in pairs(groups) do
    vim.api.nvim_set_hl(0, group, hl)
  end

  -- Explicit Lualine theme table
  local lualine_theme = {
    normal = {
      a = { fg = cp.base, bg = cp.blue, gui = "bold" },
      b = { fg = cp.text, bg = cp.surface0 },
      c = { fg = cp.text, bg = cp.base },
    },
    insert = {
      a = { fg = cp.base, bg = cp.green, gui = "bold" },
      b = { fg = cp.text, bg = cp.surface0 },
      c = { fg = cp.text, bg = cp.base },
    },
    visual = {
      a = { fg = cp.base, bg = cp.magenta, gui = "bold" },
      b = { fg = cp.text, bg = cp.surface0 },
      c = { fg = cp.text, bg = cp.base },
    },
    replace = {
      a = { fg = cp.base, bg = cp.red, gui = "bold" },
      b = { fg = cp.text, bg = cp.surface0 },
      c = { fg = cp.text, bg = cp.base },
    },
    command = {
      a = { fg = cp.base, bg = cp.yellow, gui = "bold" },
      b = { fg = cp.text, bg = cp.surface0 },
      c = { fg = cp.text, bg = cp.base },
    },
    inactive = {
      a = { fg = cp.overlay0, bg = cp.base },
      b = { fg = cp.overlay0, bg = cp.base },
      c = { fg = cp.overlay0, bg = cp.base },
    },
  }

  -- Return the theme table so it can be used in lualine config
  return {
    colors = cp,
    lualine_theme = lualine_theme,
  }
